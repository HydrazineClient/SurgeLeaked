#include "../../../SDK/Tag.h"
#include "../../Module/ModuleManager.h"
#include "GodmodeCommand.h"

GodmodeCommand::GodmodeCommand() : IMCCommand("Godmode", "Invincibility!!!", "") {
	registerAlias("god");
}

GodmodeCommand::~GodmodeCommand() {
}

bool GodmodeCommand::execute(std::vector<std::string>* args) {
	C_ItemStack* item;
	item = new C_ItemStack(***ItemRegistry::lookUpByName(std::make_unique<uintptr_t>().get(), std::make_unique<uintptr_t>().get(), TextHolder("movingblock")), 1, 0);
	std::string tag = R"({CanPlaceOn:["birch_pressure_plate","jungle_pressure_plate","dark_oak_pressure_plate","spruce_pressure_plate","dark_oak_button","carved_pumpkin","jungle_button","stone_slab3","granite_stairs","andesite_stairs","double_stone_slab3","acacia_button","birch_button","spruce_button","turtle_egg","stone_slab4","double_stone_slab4","diorite_stairs","polished_granite_stairs","polished_diorite_stairs","polished_andesite_stairs","mossy_stone_brick_stairs","smooth_red_sandstone_stairs","smooth_sandstone_stairs","blast_furnace","barrel","birch_standing_sign","smooth_quartz_stairs","smoker","end_brick_stairs","birch_wall_sign","darkoak_standing_sign","spruce_wall_sign","darkoak_wall_sign","spruce_standing_sign","normal_stone_stairs","jungle_wall_sign","red_nether_brick_stairs","jungle_standing_sign","acacia_wall_sign","mossy_cobblestone_stairs","acacia_standing_sign","loom","campfire","bee_nest","wither_rose","beehive","dispenser","sandstone","bed","web","tallgrass","wool","iron_block","deadbush","brown_mushroom","gold_block","red_mushroom","brick_block","mossy_cobblestone","mob_spawner","torch","tnt","bookshelf","redstone_wire","diamond_ore","lever","ladder","diamond_block","crafting_table","cactus","snow_layer","snow","jukebox","clay","soul_sand","glowstone","cake","fence","netherrack","trapdoor","nether_wart","blue_ice","nether_brick","melon_block","monster_egg","vine","mycelium","enchanting_table","stonebrick","beacon","fence_gate","waterlily","nether_brick_fence","brewing_stand","cauldron","tripWire","flower_pot","dragon_egg","emerald_ore","end_portal_frame","tripwire_hook","dropper","end_stone","emerald_block","cobblestone_wall","skull","anvil","seaLantern","stained_hardened_clay","quartz_block","redstone_block","slime","hopper","log2","iron_trapdoor","prismarine","hay_block","carpet","hardened_clay","coal_block","red_sandstone","spruce_fence_gate","jungle_fence_gate","birch_fence_gate","grass_path","dark_oak_fence_gate","chorus_flower","acacia_fence_gate","end_bricks","end_rod","red_nether_brick","purpur_block","magma","nether_wart_block","chorus_plant","concrete","bone_block","concretePowder","stonecutter_block","coral","coral_fan_dead","coral_block","coral_fan","wooden_pressure_plate","stone_pressure_plate","acacia_pressure_plate","light_weighted_pressure_plate","heavy_weighted_pressure_plate","grass","double_plant","stone","cobblestone","planks","dirt","sapling","bedrock","sand","gravel","gold_ore","log","coal_ore","sponge","lapis_ore","iron_ore","lapis_block","dark_oak_trapdoor","sea_pickle","bamboo","lectern","barrier","dried_kelp_block","scaffolding","birch_trapdoor","kelp","seagrass","acacia_trapdoor","jungle_trapdoor","spruce_trapdoor","smooth_stone","grindstone","cartography_table","smithing_table","bell","fletching_table","composter","lantern","wood","honeycomb_block","honey_block","leaves","nether_brick_stairs","brick_stairs","activator_rail","spruce_stairs","ender_chest","stone_brick_stairs","sandstone_stairs","wooden_slab","powered_comparator","quartz_stairs","dark_oak_stairs","standing_banner","wooden_button","daylight_detector","birch_stairs","unpowered_comparator","jungle_stairs","trapped_chest","double_wooden_slab","stained_glass_pane","leaves2","acacia_stairs","packed_ice","wall_banner","red_sandstone_stairs","stone_slab2","double_stone_slab2","spruce_door","shulker_box","white_glazed_terracotta","blue_glazed_terracotta","black_glazed_terracotta","gray_glazed_terracotta","purpur_stairs","jungle_door","purple_glazed_terracotta","magenta_glazed_terracotta","yellow_glazed_terracotta","lime_glazed_terracotta","light_blue_glazed_terracotta","cyan_glazed_terracotta","pink_glazed_terracotta","dark_oak_door","acacia_door","brown_glazed_terracotta","birch_door","orange_glazed_terracotta","silver_glazed_terracotta","green_glazed_terracotta","red_glazed_terracotta","prismarine_stairs","prismarine_bricks_stairs","observer","stained_glass","dark_prismarine_stairs","stone_slab","double_stone_slab","obsidian","detector_rail","golden_rail","yellow_flower","glass","red_flower","oak_stairs","furnace","chest","standing_sign","rail","stone_stairs","wooden_door","ice","iron_door","powered_repeater","brown_mushroom_block","wall_sign","unlit_redstone_torch","redstone_torch","redstone_ore","stone_button","pumpkin","lit_pumpkin","unpowered_repeater","red_mushroom_block","iron_bars","glass_pane"],Count:1b,Damage:0s,Name:"minecraft:movingblock",tag:{movingEntity:{id:"Beehive",Occupants:[{ActorIdentifier:"minecraft:area_effect_cloud<>",SaveData:{Duration:60,ParticleId:66,Persistent:1b,Radius:2f,TicksLeftToStay:1,definitions:["+minecraft:area_effect_cloud"],identifier:"minecraft:area_effect_cloud",mobEffects:[{Amplifier:-2b,Duration:90000000,Id:10b},{Amplifier:-2b,Duration:90000000,Id:11b},{Amplifier:25b,Duration:90000000,Id:5b},{Amplifier:-2b,Duration:90000000,Id:12b},{Amplifier:-2b,Duration:90000000,Id:13b},{Ambient:0b,Amplifier:4b,Duration:90000000,Id:21b},{Amplifier:-2b,Duration:90000000,Id:22b},{Amplifier:-2b,Duration:90000000,Id:29b}]}}]},pistonPosX:0,movingBlock:{name:"minecraft:air"},pistonPosY:0,pistonPosZ:0,ench:[{id:28s,lvl:1s}],display:{Name:"§g§lSurge Invisible CBE",Lore:["Godmode Surge NBT"]}}})";
	item->fromTag(*Mojangson::parseTag(tag));
	g_Data.getLocalPlayer()->getTransactionManager()->addInventoryAction(C_InventoryAction(0, nullptr, nullptr, item, nullptr, 1, 507, 99999));
	g_Data.getLocalPlayer()->getSupplies()->inventory->addItemToFirstEmptySlot(item);
	clientMessageF("%sPlace the item down to get Godmode!", BLUE);
	return true;
}